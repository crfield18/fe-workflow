%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\makeatletter
\newcommand{\dontusepackage}[2][]{%
  \@namedef{ver@#2.sty}{9999/12/31}%
  \@namedef{opt@#2.sty}{#1}}
\makeatother
\dontusepackage{mciteplus}

\documentclass[11pt,letterpaper,titlepage]{article}


\usepackage{amsmath,calc}
\usepackage{scalerel,amssymb,graphicx,MnSymbol}

\usepackage{indentfirst}
\usepackage{soul}
\usepackage{xcolor}
\usepackage{cleveref}
\usepackage{array}
\usepackage{multirow}
\usepackage{rotating}
\usepackage{textcomp}
\usepackage{lscape}
\usepackage{subcaption}
\usepackage{rotating}
%%\usepackage{arydshln}
\usepackage{siunitx}
\usepackage{booktabs}
\usepackage[utf8]{inputenc}
\usepackage{dcolumn}
\usepackage{array}
\usepackage{longtable}
\usepackage{tabu}
\usepackage{pdflscape}
\usepackage{hyperref}

\newcolumntype{d}[1]{D{+}{\pm}{#1}}
\newcolumntype{.}{D{.}{.}{-1}}


\usepackage{xr}
%\externaldocument[SI-]{SI.condensed}

%%%%%%%
% Format changes
% packages
\usepackage{setspace}
\usepackage[T1]{fontenc}
\usepackage[small,compact]{titlesec}
\usepackage[top=1in, bottom=1in, left=0.75in, right=0.75in] {geometry} % Margins
\usepackage[sort&compress,numbers,round]{natbib}
\usepackage[skip=2pt,font=small]{caption}
\usepackage[symbol]{footmisc}
%commands

% All font related
%%\renewcommand{\rmdefault}{phv} % Arial
%%\renewcommand{\sfdefault}{phv} % Arial
%%\titlespacing{\section}{0pt}{8pt}{5pt}
%%\titlespacing{\subsection}{0pt}{5pt}{5pt}
%%\titlespacing{\subsubsection}{0pt}{5pt}{2pt}
%%\renewcommand{\familydefault}{\sfdefault}

%% for removing numbers from sections & subsections
%%\renewcommand\thesection{}
%%\renewcommand\thesubsection{}
%%\renewcommand\thesubsubsection{}
%% section name alignment and font size
%%\titleformat{\section}[block]{\bfseries\Large\filright}{}{0em}{}
%\titleformat{\section}[block]{\bfseries\Large\filright}

%For removing brackets around bibliography list numbers
\makeatletter
\renewcommand\@biblabel[1]{#1.}
\makeatother

\captionsetup{labelsep=period}

% Itacilize section
\newenvironment{itquote}
  {\begin{quote}\itshape}
  {\end{quote}\ignorespacesafterend}
\newenvironment{itpars}
  {\par\itshape}
  {\par}

% End of format commands
%%%%%%%

\title
{\bf Automated workflow Production Free Energy Simulation Setup and Analysis (\textit{ProFESSA})}

\begin{document}

\maketitle

\section*{Tutorial for setting up alchemical free energy simulations using AMBER20 with AMBER-DD boost}
\vspace{1cm}

\section {Availability of the AMBER-DD boost package}

The AMBER Drug Discovery Boost package consists of the current release version of
AmberTools21, which can be downloaded directly from AmberMD.org, and the specialized
version of AMBER20 (the pmemd package). The AMBER20 part of AMBER Drug Discovery
Boost package is only available to AMBER20 license holders.  Active Amber developers can
access the package  directly through the Amber development GitLab repository.  For other
AMBER20 license holders, the primary mode for accessing the AMBER Drug Discovery Boost
package is through GitLab repository set up through the laboratory for Biomolecular
Simulation Research (LBSR) at Rutgers, which mirrors the AMBER Drug Discovery Boost
package in the Amber development GitLab repository.

A verified AMBER20 license holder will need a GitLab account in order to access the
AMBER Drug Discovery Boost GitLab repository. A new GitLab
account can easily be obtained at www.GitLab.com.  The user first need to send the
e-mail address/username associated with the GitLab account to: Abir Ganguly at
abir.ganguly@rutgers.edu or Darrin York at Darrin.York@rutgers.edu in order to be added to
the AMBER Drug Discovery Boost  GitLab projects.
\textit{Note}: if you have created a new GitLab account through a social media account
such as Google or Facebook, you will need to manually set up your GitLab password in order
for git clone to work. Once added, the user will receive three separate notification
emails confirming that the user has been added to the following three projects:\\

\flushleft{
Laboratory for Biomolecular Simulation Research / AMBER Drug Discovery Boost \\
Laboratory for Biomolecular Simulation Research / Alchemical\_FE \\
Laboratory for Biomolecular Simulation Research / FE-ToolKit \\
}

Upon this confirmation the user will be able to check out the packages as follows: \\

\flushleft{
With ssh-key setup in GitLab (recommended):  \\
git clone git@gitlab.com:RutgersLBSR/amber-drug-discovery-boost.git \\
git clone git@gitlab.com:RutgersLBSR/Alchemical\_fe.git \\
git clone git@gitlab.com:RutgersLBSR/FE-ToolKit.git \\
}

\flushleft{
Without ssh-key setup in GitLab: \\
git clone https://gitlab.com/RutgersLBSR/amber-drug-discovery-boost.git \\
git clone https://gitlab.com/RutgersLBSR/Alchemical\_fe.git \\
git clone https://gitlab.com/RutgersLBSR/FE-ToolKit.git \\
}

The \textit{Alchemical\_fe} folder contains the following sub-folders:
\begin{itemize}
        \item{\textit{Documentation} - containing documentation specific to AMBER Drug Discovery Boost}
        \item{\textit{Tutorials} - containing tutorials for setting up alchemical free energy simulations using AMBER Drug Discovery Boost}
        \item{\textit{Examples} - containing test cases for relative binding free energy (RBFE) and relative solvation free energy (RSFE) calculations}
        \item{\textit{bin} - containing scripts to help set up alchemical free energy simulations using Amber Drug Discovery Boost}
\end{itemize}

%%\setlength{\parindent}{20pt}

We are also in the process of putting documentation up on the Wiki site that will be updated on a regular basis - \url{https://gitlab.com/RutgersLBSR/alchemical\_fe/-/wikis/Setup-AFE\_AMBER\_DD\_BOOST}


\vspace{1cm}
\section{Purpose of \textit{setup\_fe}}
\vspace{1cm}

The \textit{setup\_fe} script is designed to help setup the directory structure and input files that are necessary for 
running alchemical free energy simulations with AMBER-DD Boost. The script accepts a simplified input file named \textit{‘input’} that
is described in detail later in the tutorial. Briefly, for a given system, such as a specific protein target, or a collection of 
small molecules, a) a list of desired transformations can be provided, b) key simulation settings can be specified, 
and c) initial configuration files (MD equilibrated parameter (parm) and coordinate (rst) files associated with the system and
specified transformations) must be provided. \textit{setup\_fe} can then be used to generate a hierarchy of directories 
containing relevant parameter, coordinate, and AMBER input files and job submission scripts. \textit{setup\_fe} can subsequently be used 
to analyze the free energy simulations using \textit{FE-ToolKit}


\vspace{1cm}
\section{Initial requirements of \textit{setup\_fe}}
\vspace{1cm}

Following conditions must be met before running \textit{setup\_fe} -
\renewcommand{\labelenumi}{\Roman{enumi}}
\begin{enumerate}
	\item {\textit{AMBERHOME needs to be set}}
	\item{\textit{cpptraj}(AmberTools) needs to be installed and available in \$PATH}
	\item{\textit{parmed}(AmberTools) needs to be installed and available in \$PATH}
	\item{\textit{python3} needs to be installed and available in \$PATH}
	\item{\textit{bin} subdirectory within \textit{Alchemical\_fe} folder needs to be available in \$PATH}
	\item{\textit{RDKit} needs to be installed and python3 bindings to \textit{RDKit} needs to be available in \$PYTHONPATH}
	\begin{itemize}
		\item{\textit{RDKit} can be installed with a package manager}
		\begin{itemize}
			\item{Fedora - \textit{sudo dnf install rdkit.x86\_64 python3-rdkit.x86\_64}}
			\item{Ubuntu - \textit{sudo apt install python-rdkit}}
		\end{itemize}
		\item{or, \textit{RDKit} can be installed using \textit{conda}}
		\begin{itemize}
			\item{See \url{http://www.rdkit.org/docs/Install.html\#installation for details}}
		\end{itemize}
	\end{itemize}
	\item{folder containing initial structure and parameter files}
		\begin{itemize}
			\item For relative binding free energy (RBFE) calculations, this folder should contain, for each \\
				intended transformation (edge), PDB file(s) of the protein-ligand(s) complex(es) and  \\
				parameter (mol2, lib, frcmod) files for the associated ligands and any nonstandard residues  \\
				present in the protein-ligand PDB file(s).  \\
				For relative and absolute solvation free energy (RSFE, ASFE) calculations, this folder \\
				should contain, for each intended transformation, parameter (mol2, lib, frcmod) files for the  \\
				associated ligand(s). \\
				For further details related to input format please refer to Table~1 \\
		\end{itemize}
\end{enumerate}

\vspace{1cm}
\section{Setup of \textit{setup\_fe}}
\vspace{1cm}

The \textit{setup\_fe} script can be created by running the script \textit{makesetup\_fe.sh} located in the \textit{bin} subdirectory
of the \textit{Alchemical\_fe} folder. 

\vspace{0.1cm}
\centerline{./makesetup\_fe.sh}
\vspace{0.1cm}

\textit{makesetup\_fe.sh} help set the following three variables : \${pathTOWRKDIR}, 
\${pathTOWFToolKit}, and \${pathTOFEToolKit} within \textit{setup\_fe}. 
\begin{enumerate}
	\item{\${pathTOWRKDIR} should be set to the intended working directory.}
	\item{\${pathTOWFToolKit} should be set to the path of the \textit{Alchemical\_fe} folder.}
	\item{\${pathTOFEToolKit} should be set to the path of the \textit{FE-ToolKit} folder.}
\end{enumerate}
By defaults, these variables are set to the path of the \textit{current working directory}. Alternatively, these variables 
can be modified manually in \textit{setup\_fe}.


\vspace{1cm}
\section{Input file for \textit{setup\_fe}}
\vspace{1cm}

\textit{setup\_fe} requires an input file named \textit{input} that contains key settings of the
alchemical free energy simulations that are going to be set up. A template input file can be
generated by running the script with a flag \textit{-h} or \textit{-help}. A typical input file looks like the
following -

\vspace{1cm}
\begin{itquote}
	
{\color{blue}
	
path\_to\_input=initial 			\\
system=CDK2 					\\

translist=(1h1q~1h1s 1h1q~1oi9 1oi9~1h1s) 	\\
nlambda=11  					\\
protocol=unified 				\\

mapmethod=2 					\\
mapinspect=0 					\\
mapnetwork=true 				\\

boxbuild=1 					\\
boxbufcom=16  		 			\\
boxbufaq=20		 			\\
ionconc=0.15		 			\\
pff=ff14SB					\\
lff=gaff2					\\
wm=tip4pew					\\
mdboxshape=cubic				\\

ntrials=3					\\

cutoff=10               			\\
repex=true 					\\
nstlimti=5000           			\\
numexchgti=1000         			\\
hmr=false 					\\
notrajectory=true				\\

scalpha=0.5             			\\
scbeta=1.0              			\\
gti\_add\_sc=5 					\\
gti\_scale\_beta=1      			\\
gti\_cut=1              			\\
gti\_cut\_sc\_on=8      			\\
gti\_cut\_sc\_off=10    			\\
gti\_lam\_sch=1         			\\
gti\_ele\_sc=1          			\\
gti\_vdw\_sc=1          			\\
gti\_cut\_sc=2          			\\
gti\_ele\_exp=2         			\\
gti\_vdw\_exp=2         			\\

twostate=false 					\\
bidirection\_aq=true 				\\
bidirection\_com=true 				\\

ticalc=rbfe                      		\\
stage=analysis                   		\\
setupmode=0                      		\\

partition=general-long-gpu       		\\
nnodes=1                        		\\
ngpus=8                        			\\
wallclock=3-00:00:00          			\\

path\_to\_data=data 				\\
exptdatafile=skip 				\\
bar=true 					\\
ccc=false 					\\
ccc\_ddG=true 					\\
start=0.0 					\\
stop=100.0 					\\
check\_convergence=true 			\\
showallcycles=true 				\\

}

\end{itquote}

Table 1 provides a detailed description of keywords that are specific to \textit{setup\_fe}. For 
keywords/flags that are specific to AMBER20 and AMBER-DD Boost refer to the 
\href{https://ambermd.org/doc12/Amber20.pdf}{AMBER20 reference manual}
and \textit{AMBER-DD Boost Documentation}.


\vspace{1cm}
\section{File infrastructure created by \textit{setup\_fe}}
\vspace{1cm}

With the \textit{input} file present in \$pathTOWRKDIR, \textit{setup\_fe} can be executed as 

\vspace{0.1cm}
\centerline{./setup\_fe}
\vspace{0.1cm}

In \textit{"setup"} mode, \textit{setup\_fe} creates a folder named \textit{"system"}, as defined i
in the \textit{input} file in \$pathTOWRKDIR. 
The \textit{"system"} folder will have two subdirectories, \textit{setup} and \textit{run}. The folder
\textit{setup} will house the  various intermediate files that were generated and used in creating 
the final input files. The folder \textit{run} will contain independent subdirectories corresponding 
to each entry (transformation) in the keyword \textit{"translist"} in the \textit{input} file. These 
subdirectories that will have the same naming convention as provided in the \textit{input} file, 
will further contain subdirectories named \textit{"com"} and \textit{"aq"} for RBFE calculations, or 
only the subdirectory \textit{"aq"} for RSFE and ASFE calculations. The \textit{"com"} and \textit{"aq"}
subdirectories correspond to complex and aqueous simulations, respectively, and will contain 
the final merged TI parameter and coordinate input files, template submission slurm scripts, an
\textit{input} folder containing relevant AMBER input files, and production sub-folders corresponding 
to each specified independent trial that will house the production simulation data. 

In \textit{"analysis"} mode, \textit{setup\_fe} creates a folder named \textit{results} in \$pathTOWRKDIR. 
The \textit{results} folder will contain a subdirectory \textit{data} that will have a nested directory 
structure containing Energy and DV/DL data from the various simulations in the transformation network 
being analyzed. The \textit{results} folder will also contain the graphmbar input file named
\textit{graphmbar.inp} for \textit{FE-Toolkit}, a python script named \textit{gmbar.py} that facilitates 
the generation of the graphmbar input file, the graphmbar output file named \textit{graphmbar.out} 
generated by \textit{FE-Toolkit}, and a simplified output file named \textit{out} summarizing the final 
free energy results of the entire transformation network.






\newcolumntype{P}[1]{>{\RaggedRight\arraybackslash\hspace{0pt}}p{#1}}
\begin{footnotesize}
\begin{landscape}
\begin{center}
\begin{longtable}[1]{p{3cm}|p{0.5cm}|p{11cm}|p{4cm}}
\caption{Keywords associated with the \textit{ProFESSA} workflow} \label{table:keywords} \\

\hline \multicolumn{1}{c|}{\textbf{Keyword}} & \multicolumn{1}{c|}{\textbf{Value}} & \multicolumn{1}{c|}{\textbf{Description}} & \multicolumn{1}{c}{\textbf{Example}} \\ \hline
\endfirsthead

\multicolumn{4}{c}%
{{\bfseries \tablename\ \thetable{} -- continued from previous page}} \\
\hline \multicolumn{1}{c|}{\textbf{Keyword}} & \multicolumn{1}{c|}{\textbf{Value}} & \multicolumn{1}{c|}{\textbf{Description}} & \multicolumn{1}{c}{\textbf{Example}} \\ \hline
\endhead

\hline \multicolumn{4}{r}{{Continued on next page}} \\ \hline
\endfoot

\hline \hline
\endlastfoot



path\_to\_input    & string          & Path to directory that contains input files. It should contain a subdirectory \textit{system}.  & path\_to\_input =/home/username/afe/initial                       \\ 
\hline
system             & string          & Name of the system. A folder named system should be present in \textit{path\_to\_input/}, and should contain the initial structure and parameter files.      & system=CDK2             \\ 
\hline
translist          & list of strings & A list of desired transformations or edges. In the case of RBFE or RSFE calculations, \textit{translist} should be a list in which each entry consists of two molnames separated by the character "\textasciitilde{}", while in the case of ASFE calculations, \textit{translist} should be a list of molnames. Initial structure/parameter files of these molnames should be provided in~\textit{path\_to\_input/system }and should be named as follows:  \newline For RBFE calculations, each molname present in \textit{translist} should have an associated~\textit{molname.pdb}, representing the receptor-ligand complex structure and [\textit{molname\_0.mol2 molname\_0.lib}~\textit{molname\_0.frcmod]}, representing the ligand parameters. Parameters of additional non-standard residues, if present, can be provided as [\textit{molname\_1.mol2 molname\_1.lib molname\_1.frcmod]}, [\textit{molname\_2.mol2 molname\_2.lib molname\_2.frcmod]}, etc.\newline For RSFE and ASFE calculations, each molname present in \textit{translist} should have associated [\textit{molname\_0.mol2}~\textit{molname\_0.lib}~ \textit{molname\_0.frcmod] }files. & translist=(1h1q\textasciitilde{}1h1r 1h1q\textasciitilde{}1h1s)  \\ 
\hline
ticalc             & string          & Specifies nature of calculation. Acceptable values - \textit{rbfe}, \textit{rsfe}, \textit{asfe}.   & ticalc=rbfe  \\ 
\hline
nlambda            & integer         & Number of lambda windows in TI calculation. Acceptable values - positive integers.   & nlambda=21   \\ 
\hline
protocol           & string          & Protocol for running TI simulations. Acceptable value - \textit{unified}.     & protocol=unified     \\ 
\hline
	mapmethod          & integer         & Specifies the algorithm using which TS/TC regions are going to be determined. Acceptable values - \textit{0}, \textit{1}, \textit{2}. \newline \textit{0} specifies MCS algorithm. \newline \textit{1} specifies MCS-E algorithm. \newline \textit{2} specifies MCS-E2 algorithm. \newline For a given transformation/edge~\textit{molname1\textasciitilde{}molname2} in \textit{translist}, an atom map file, \textit{molname1\textasciitilde{}molname2.map.txt}, is generated in the folder \textit{system/setup}.   & mapmethod=1      \\ 
\hline
	mapinspect         & integer         & Allows manual inspection of TS/TC regions. Acceptable values -~\textit{0, 1, 2.} \newline \textit{0} specifies no manual inspection. \newline\textit{1} specifies manual inspection. \newline \textit{2} specifies resume setup assuming manual inspection has been completed. \newline If \textit{mapinspect} is set to \textit{2}, the necessary atom map files should be present in \textit{system/setup} folder. & mapinspect=true \\
\hline
mapnetwork         & string          & Specifies if network-wide consistent TS/TC regions of ligands will be generated. Acceptable values - \textit{true},\textit{false}.    & mapnetwork=false     \\ 
\hline
boxbuild           & string /\newline integer  & Specifies if and how MD boxes will be built. Acceptable values - \textit{0}, \textit{1}, \textit{2}, \textit{skip}.\newline \textit{0} specifies to build boxes only for "aqueous" state and not for "complex" state.\newline \textit{1} specifies to build boxes for both "aqueous" and "complex" states.\newline \textit{2} specifies to build boxes for both "aqueous" and "complex" states with identical number of water and ions.\newline \textit{skip} specifies to skip box building altogether.\newline For RSFE and ASFE calculations, \textit{boxbuild 0} and \textit{1} are identical. & boxbuild=1   \\ 
\hline
boxbufcom          & integer         & Specifies MD box buffer for "complex" states. Relevant only for RBFE calculations. Acceptable values - positive integers. & boxbufcom=16   \\ 
\hline
boxbufaq           & integer         & Specifies MD box buffer for "aqueous" states. Relevant only for RBFE calculations. Acceptable values - positive integers.   & boxbufaq=21  \\ 
\hline
ionconc            & float           & Specifies the MD box ion concentration in units of mol/L (M). Acceptable values - positive real number.  & ionconc=0.15  \\ 
\hline
pff                & string          & Specifies protein forcefield. Acceptable values - \textit{ff14SB}  & pff=ff14SB   \\ 
\hline
lff                & string          & Specifies ligand forcefield. Acceptable values - \textit{gaff}, \textit{gaff2}  & lff=gaff2 \\ 
\hline
wm                 & string          & Specifies water model. Acceptable values - \textit{tip4pew}, \textit{tip3p}  & wm=tip4pew  \\ 
\hline
mdboxshape         & string          & Specifies shape of MD box. Acceptable values - \textit{cubic}  & mdboxshape=cubic  \\ 
\hline
ntrials            & integer         & Specifies the number of independent trials of calculation. Acceptable values - positive integers.  & ntrials=10  \\ 
\hline
cutoff             & integer         & Specifies non-bonded cutoff in TI simulations. Acceptable values - positive integers.  & cutoff=10  \\ 
\hline
repex              & string          & Specifies if Hamiltonian Replica Exchange will be employed. & repex=true    \\ 
\hline
nstlimti           & integer         & Specifies the length of production TI simulations in units of fs. Acceptable values - positive integers.  & nstlimti=5000   \\ 
\hline
numexchgti         & integer         & Specifies the number of exchanges in replica exchange TI simulations. \textit{numexchgti} is ignored is \textit{repex} is set to false. Acceptable values - positive integers.  & numexchgti=1000     \\ 
\hline
hmr                & string          & Specifies if Hydrogen Mass Repartitioning will be used. Acceptable values - \textit{true}, \textit{false}.   & hmr=false   \\ 
\hline
notrajectory       & string          & Specifies if production trajectories will be saved during TI simulations. Acceptable values - \textit{true}, \textit{false}.  & notrajectory=true  \\ 
\hline
scalpha            & float           & Specifies the value of \textit{AMBER DD BOOST} keyword \textit{scalpha} in TI simulations. Acceptable values - positive real numbers.   & scalpha=0.5   \\ 
\hline
scbeta             & float           & Specifies the value of \textit{AMBER DD BOOST} keyword \textit{scbeta}~in TI simulations. Acceptable values - positive real numbers.   & scbeta=0.5  \\ 
\hline
gti\_add\_sc       & integer         & Specifies the value of \textit{AMBER DD BOOST} keyword \textit{gti\_add\_sc} in TI simulations. Acceptable values - positive integers.  & gti\_add\_sc=5     \\ 
\hline
gti\_scale\_beta   & float           & Specifies the value of \textit{AMBER DD BOOST} keyword \textit{gti\_scale\_beta} in TI simulations. Acceptable values - positive real number.  & gti\_scale\_beta=1  \\ 
\hline
gti\_cut           & integer         & Specifies the value of \textit{AMBER DD BOOST} keyword \textit{gti\_cut} in TI simulations. Acceptable values - positive integers.  & gti\_cut=1  \\ 
\hline
gti\_cut\_sc\_on   & integer         & Specifies the value of \textit{AMBER DD BOOST} keyword \textit{gti\_cut\_sc\_on} in TI simulations. Acceptable values - positive integers.  & gti\_cut\_sc\_on=8  \\ 
\hline
gti\_cut\_sc\_off  & integer         & Specifies the value of \textit{AMBER DD BOOST} keyword \textit{gti\_cut\_sc\_off} in TI simulations. Acceptable values - positive integers.  & gti\_cut\_sc\_off=10  \\ 
\hline
gti\_lam\_sch      & integer         & Specifies the value of \textit{AMBER DD BOOST} keyword \textit{gti\_lam\_sch} in TI simulations. Acceptable values - positive integers.  & gti\_lam\_sch=1  \\ 
\hline
gti\_ele\_sc       & integer         & Specifies the value of \textit{AMBER DD BOOST} keyword \textit{gti\_ele\_sc} in TI simulations. Acceptable values - positive integers. & gti\_ele\_sc=1  \\ 
\hline
gti\_vdw\_sc       & integer         & Specifies the value of \textit{AMBER DD BOOST} keyword \textit{gti\_vdw\_sc} in TI simulations. Acceptable values - positive integers.  & gti\_vdw\_sc=1  \\ 
\hline
gti\_cut\_sc       & integer         & Specifies the value of \textit{AMBER DD BOOST} keyword \textit{gti\_cut\_sc} in TI simulations. Acceptable values - positive integers.   & gti\_cut\_sc=1  \\ 
\hline
gti\_ele\_exp      & integer         & Specifies the value of \textit{AMBER DD BOOST} keyword \textit{gti\_ele\_exp} in TI simulations. Acceptable values - positive integers.  & gti\_ele\_exp=2  \\ 
\hline
gti\_vdw\_exp      & integer         & Specifies the value of \textit{AMBER DD BOOST} keyword \textit{gti\_vdw\_exp} in TI simulations. Acceptable values - positive integers. & gti\_vdw\_exp=2  \\ 
\hline
twostate           & string          & Specifies if twostate setup will be employed in TI simulations. Acceptable values - \textit{true}, \textit{false}. & twostate=true  \\ 
\hline
bidirection\_aq    & string          & Specifies if bidirectional setup will be used for "aqueous" state TI simulations. Applicable when \textit{twostate} is set to \textit{false}. Acceptable values - \textit{true}, \textit{false}.  & bidirection\_aq=false  \\ 
\hline
bidirection\_com   & string          & Specifies if bidirectional setup will be used for "complex" state TI simulations. Applicable when \textit{twostate} is set to \textit{false}. Acceptable values - \textit{true}, \textit{false}. & bidirection\_aq=false  \\ 
\hline
stage              & string          & Specifies the action of the script. Acceptable values - \textit{setup}, \textit{analysis}.\newline \textit{setup} specifies script to set up TI simulations.\newline \textit{analysis} specifies script to perform analysis. & stage=setup  \\ 
\hline
setupmode          & integer         & Specifies the mode of simulation setup. Acceptable values - \textit{0}\newline \textit{0} sets up regular TI simulations. & setupmode=0  \\ 
\hline
partition          & string          & Specifies the HPC partition on which TI runs will be performed. Acceptable values - \textit{null}, \textit{name of HPC partition}. & partition=gpu  \\ 
\hline
nnodes             & integer         & Specifies the number of nodes to be requested for a single set of TI simulations. Acceptable values - positive integer. & nnodes=1  \\ 
\hline
ngpus              & integer         & Specifies the number of gpus per node to be requested for a single set of TI simulations. Acceptable values - positive integer.  & ngpus=8  \\ 
\hline
wallclock          & string          & Specifies the wallclock on TI jobs. Acceptable values - formatted time in hours:minutes:days. & wallclock=3-00:00:00                                             \\ 
\hline
path\_to\_data     & string          & Specifies the path to production runs. Default path is set to \textit{system/protocol/run}  & path\_to\_data=CDK2/unified/run   \\ 
\hline
exptdatafile       & string          & Specifies the name of a text file containing experimental ligand binding free energies. Acceptable values - \textit{skip}, \textit{filename}.\newline The text file should have two columns corresponding to \textit{molname} (column 1) and relative ligand binding free energy (column 2). & exptdatafile=Expt.dat  \\ 
\hline
bar                & string          & Specifies if BAR is going to be used for analysis instead of MBAR. Acceptable values - \textit{true}, \textit{false}.  & bar=false   \\ 
\hline
ccc                & string          & Specifies if cycle closure corrections are to be applied during analysis. Acceptable values - \textit{true}, \textit{false}. & ccc=true  \\ 
\hline
ccc\_ddG           & string          & Specifies if cycle closures will be applied to \textit{"complex" - "aqueous"} delta delta Gs instead of \textit{"complex"} and \textit{"aqueous"} delta Gs, independently. Acceptable values - \textit{true}, \textit{false}. & ccc\_ddG=true  \\ 
\hline
start              & float           & Specifies the percentage of data to ignore from the beginning of TI production runs. Acceptable values - float numbers ranging from 0 to 100, and less than \textit{stop}.  & start=20.0  \\ 
\hline
stop               & float           & Specifies the percentage of data to read from the start of TI production runs. Acceptable values - float numbers ranging from 0 to 100, and greater than \textit{start}.  & stop=100.00   \\ 
\hline
check\_convergence & string          & Specifies if check of data convergence will be carried out during analysis. Acceptable values - \textit{true}, \textit{false}.\newline If \textit{check\_convergence} is set to \textit{true}, the analysis is carried out multiple times, for a range of \textit{start} and \textit{stop} values. & check\_convergence=true  \\
\hline
showallcycles      & string          & Specifies if the output should show information on all possible cycles within the given transformation network. Acceptable values - \textit{true}, \textit{false}. & showallcycles=true  \\
\hline
\end{longtable}
\end{center}
\end{landscape}
\end{footnotesize}


\end{document}
